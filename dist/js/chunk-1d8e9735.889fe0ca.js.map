{"version":3,"sources":["webpack:///./src/views/Login/Login.vue?7596","webpack:///src/views/Login/Login.vue","webpack:///./src/views/Login/Login.vue?55cf","webpack:///./src/views/Login/Login.vue","webpack:///./src/api/user.js","webpack:///./src/views/Login/Login.vue?a352"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","user","formRules","model","value","callback","$$v","$set","expression","_v","lodingBtn","on","onLogin","staticRenderFns","data","mobile","code","agree","methods","$refs","validate","valid","login","message","type","component","request","method","url","cropperImage","userChange","userProfile","JSON","parse","window","localStorage","getItem","headers","Authorization","token"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,UAAU,CAACG,IAAI,YAAYD,YAAY,aAAaE,MAAM,CAAC,MAAQR,EAAIS,KAAK,MAAQT,EAAIU,YAAY,CAACN,EAAG,eAAe,CAACE,YAAY,OAAOE,MAAM,CAAC,YAAc,SAAS,KAAO,WAAW,CAACJ,EAAG,WAAW,CAACO,MAAM,CAACC,MAAOZ,EAAIS,KAAW,OAAEI,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIS,KAAM,SAAUK,IAAME,WAAW,kBAAkB,GAAGZ,EAAG,eAAe,CAACE,YAAY,OAAOE,MAAM,CAAC,YAAc,SAAS,KAAO,SAAS,CAACJ,EAAG,WAAW,CAACO,MAAM,CAACC,MAAOZ,EAAIS,KAAS,KAAEI,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIS,KAAM,OAAQK,IAAME,WAAW,gBAAgB,GAAGZ,EAAG,eAAe,CAACI,MAAM,CAAC,KAAO,UAAU,CAACJ,EAAG,cAAc,CAACE,YAAY,QAAQK,MAAM,CAACC,MAAOZ,EAAIS,KAAU,MAAEI,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIS,KAAM,QAASK,IAAME,WAAW,eAAe,CAAChB,EAAIiB,GAAG,eAAe,GAAGb,EAAG,eAAe,CAACA,EAAG,YAAY,CAACE,YAAY,WAAWE,MAAM,CAAC,QAAUR,EAAIkB,UAAU,KAAO,WAAWC,GAAG,CAAC,MAAQnB,EAAIoB,UAAU,CAACpB,EAAIiB,GAAG,WAAW,IAAI,IAAI,IACviCI,EAAkB,G,YCoCtB,GACEC,KADF,WAEI,MAAO,CACLb,KAAM,CACJc,OAAQ,cACRC,KAAM,SACNC,OAAO,GAGTP,WAAW,EACXR,UAAW,CACTa,OAAQ,CAChB,CAAU,UAAV,EAAU,QAAV,YAAU,QAAV,UACA,CAAU,QAAV,oBAAU,QAAV,cAAU,QAAV,WAEQC,KAAM,CACd,CAAU,UAAV,EAAU,QAAV,SAAU,QAAV,UACA,CAAU,QAAV,UAAU,QAAV,cAAU,QAAV,WAEQC,MAAO,CAEP,CAAE,UAAV,gBAGA,EACc,IAEA,EAAd,yBAGU,QAAV,cAMEC,QAAS,CACPN,QADJ,WACA,WAIMnB,KAAK0B,MAAM,aAAaC,UAAS,SAAvC,GACaC,GAKL,EAAR,YAKIC,MAhBJ,WAgBA,WAEM7B,KAAKiB,WAAY,EACjB,OAAN,OAAM,CAAN,6BAEQ,EAAR,UACUa,QAAS,OACTC,KAAM,YAGR,EAAR,aAKQ,OAAR,yDAEQ,EAAR,cACU,KAAV,YAEA,mBAEQ,EAAR,gCAEQ,EAAR,mBCjH8V,I,wBCQ1VC,EAAY,eACd,EACAlC,EACAsB,GACA,EACA,KACA,WACA,MAIa,aAAAY,E,kEClBf,wJAGaH,EAAQ,SAAAR,GACnB,OAAOY,eAAQ,CACbC,OAAQ,OACRC,IAAK,0BAELd,UAKSe,EAAe,SAAAf,GAE1B,OAAOY,eAAQ,CACbC,OAAQ,QACRC,IAAK,sBACLd,UAISgB,EAAa,SAAAhB,GACxB,OAAOY,eAAQ,CACbC,OAAQ,QACRC,IAAK,wBACLd,UAMSiB,EAAc,WAGzB,IAAM9B,EAAO+B,KAAKC,MAAMC,OAAOC,aAAaC,QAAQ,SAEpD,OAAOV,eAAQ,CACbC,OAAQ,MACRC,IAAK,wBACLS,QAAS,CAGPC,cAAe,UAAF,OAAYrC,EAAKsC,Y,kCC5CpC,yBAA2jB,EAAG","file":"js/chunk-1d8e9735.889fe0ca.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login-container\"},[_c('el-form',{ref:\"login-ref\",staticClass:\"login-from\",attrs:{\"model\":_vm.user,\"rules\":_vm.formRules}},[_c('el-form-item',{staticClass:\"item\",attrs:{\"placeholder\":\"请输入手机号\",\"prop\":\"mobile\"}},[_c('el-input',{model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}})],1),_c('el-form-item',{staticClass:\"item\",attrs:{\"placeholder\":\"请输入验证码\",\"prop\":\"code\"}},[_c('el-input',{model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"agree\"}},[_c('el-checkbox',{staticClass:\"agree\",model:{value:(_vm.user.agree),callback:function ($$v) {_vm.$set(_vm.user, \"agree\", $$v)},expression:\"user.agree\"}},[_vm._v(\"同意用户隐私协议\")])],1),_c('el-form-item',[_c('el-button',{staticClass:\"loginBtn\",attrs:{\"loading\":_vm.lodingBtn,\"type\":\"primary\"},on:{\"click\":_vm.onLogin}},[_vm._v(\" 登录 \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"login-container\">\r\n    <!-- 表单验证就在form中:model绑定要验证的名字、:rules绑定验证规则，表单item中用prop绑定名字， -->\r\n    <!-- 手动添加登录验证，就是在表单验证不通过时不会发请求，给form添加ref -->\r\n    <el-form\r\n      class=\"login-from\"\r\n      :model=\"user\"\r\n      :rules=\"formRules\"\r\n      ref=\"login-ref\">\r\n      <el-form-item class=\"item\" placeholder=\"请输入手机号\" prop=\"mobile\">\r\n        <el-input v-model=\"user.mobile\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item class=\"item\" placeholder=\"请输入验证码\" prop=\"code\">\r\n        <el-input v-model=\"user.code\"></el-input>\r\n      </el-form-item>\r\n      <!-- 注意这里绑定prop不是给checkbox绑定，而是表单item绑 -->\r\n      <el-form-item prop=\"agree\">\r\n        <!-- 自定义验证规则，就给这个绑定prop -->\r\n        <!-- v-model中复选框绑定到表单验证中user.agree -->\r\n        <el-checkbox class=\"agree\" v-model=\"user.agree\">同意用户隐私协议</el-checkbox>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button\r\n          :loading=\"lodingBtn\"\r\n          class=\"loginBtn\"\r\n          type=\"primary\"\r\n          @click=\"onLogin\">\r\n          登录\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//export 导出的东西要按需导入{ login }\r\nimport { login } from '@/api/user'\r\nexport default {\r\n  data() {\r\n    return {\r\n      user: {\r\n        mobile: '13911111111',\r\n        code: '246810',\r\n        agree: false //默认不同意协议\r\n      },\r\n      // checked: false, //已同意框选中,自定义规则的话，那这个选中状态的就不需要了\r\n      lodingBtn: false, //加载按钮默认为false\r\n      formRules: {\r\n        mobile: [\r\n          { required: true, message: '请输入正确的手机号', trigger: 'change' },\r\n          { pattern: /^1[3456789]\\d{9}$/, message: ' 请输入正确格式手机号', trigger: 'change' }\r\n        ],\r\n        code: [\r\n          { required: true, message: '请输入验证码', trigger: 'change' },\r\n          { pattern: /^\\d{6}$/, message: ' 请输入正确格式验证码', trigger: 'change' }\r\n        ],\r\n        agree: [\r\n          // 这里是validator，不是validate\r\n          { validator: (rule, value, callback) => {\r\n            // validate有三个参数，这里的value返回的时false\r\n              // console.log(value);\r\n              if(value) {\r\n                callback()\r\n              }else {\r\n                callback(new Error('请同意用户隐私协议'))\r\n              }\r\n            },\r\n            trigger: 'change'\r\n          },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    onLogin() {\r\n      // 根据文档存储请求\r\n      // const user = this.user\r\n      // 先进性验证，再登录，不通过则不登陆\r\n      this.$refs['login-ref'].validate(valid => {\r\n        if (!valid) {\r\n            // return this.$message.error('请输入手机号或验证码');\r\n            return\r\n        }\r\n        //如果通过验证，就进行login方法的调用\r\n        this.login();\r\n      });\r\n    },\r\n    //发送请求\r\n    // 在上面如果通过验证就调用这个方法，是为了封装而已，\r\n    login() {\r\n      // 点击登录按钮以后将按钮禁用为加载状态按钮，加上this.来拿\r\n      this.lodingBtn = true\r\n      login(this.user).then(res => {\r\n        // console.log(res);\r\n        this.$message({\r\n          message: '登陆成功',\r\n          type: 'success'\r\n        });\r\n        // 登录成功就将按钮恢复正常\r\n          this.lodingBtn = false\r\n\r\n          // 将接口返回的res中的数据存储到本地，方便数据共享,本地存储只能存储字符串，而这里存储的是一个对象，这里的res.data.data调用了toString()，然后存进去就是一个[object Object]\r\n          // 用JSON.stringify(res.data.data),转为JSON格式字符串\r\n          // 这里有个坑耽误了很久，不是getItem，是setItem！！！！！！！！\r\n          window.localStorage.setItem('user',JSON.stringify(res.data.data))\r\n          // 登录成功就进入到首页\r\n          this.$router.push({\r\n            name: 'home'\r\n          })\r\n      }).catch(err => {\r\n        // console.log('登录失败',err);\r\n        this.$message.error('登录失败，手机或验证码错误');\r\n        // 登录失败也将按钮恢复正常\r\n          this.lodingBtn = false\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.login-container {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background: url('./Login-img.jpg') no-repeat;\r\n  background-size: cover;\r\n  // opacity: 0.5;\r\n  .login-from {\r\n    padding: 100px 50px;\r\n    background-color: rgb(36, 35, 35);\r\n    height: 220px;\r\n    width: 300px;\r\n    .agree {\r\n      color: #fff;\r\n      // font-size: 200px;\r\n    }\r\n    .loginBtn {\r\n      // margin-left: 100px;\r\n      width: 100%;\r\n  }\r\n  }\r\n  \r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=2db46dcc&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=2db46dcc&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2db46dcc\",\n  null\n  \n)\n\nexport default component.exports","\r\n//导入request模块\r\nimport request from '@/utils/Request'\r\n//用户登录\r\nexport const login = data => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/mp/v1_0/authorizations',\r\n    // 这里的user就变成了this.user.\r\n    data\r\n  })\r\n}\r\n\r\n//裁切好的图片请求\r\nexport const cropperImage = data => {\r\n  // 两个参数，一个是请求图片id，一个是请求body的collect\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/mp/v1_0/user/photo',\r\n    data\r\n  })\r\n}\r\n//个人信息修改的请求\r\nexport const userChange = data => {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/mp/v1_0/user/profile',\r\n    data\r\n  })\r\n}\r\n\r\n\r\n//用户个人资料显示，头像、昵称\r\nexport const userProfile = () => {\r\n  // 这里用user变量得到login中存储的JSON格式字符串\r\n  // const user = window.localStorage.setItem('user'),这样写会报错,要用JSON.parse（）转回对象,这里是getItem，使用user，存的时候是set\r\n  const user = JSON.parse(window.localStorage.getItem('user'))\r\n  // console.log(user)\r\n  return request({\r\n    method: 'GET',\r\n    url: '/mp/v1_0/user/profile',\r\n    headers: {\r\n    //   这里时规定的，请求头格式Authorization：'Bearer空格network中返回的token',然后这里拼接上这个token，用反引号拼接\r\n    //   几乎所有接口都会需要这个token，统一设定token\r\n      Authorization: `Bearer ${user.token}`\r\n      // Authorization: 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2MzQzNjk0MDcsInVzZXJfaWQiOjEsInJlZnJlc2giOmZhbHNlLCJ2ZXJpZmllZCI6dHJ1ZX0.e9B2z2CFJrncS64pFmJW22VP_VkGexhLIKrFGUqSLvU'\r\n    //   在拦截器中已经写了，这里就不用写了，所有的请求中都不用写了\r\n    }\r\n  })\r\n}","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=2db46dcc&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=2db46dcc&lang=less&scoped=true&\""],"sourceRoot":""}